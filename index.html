<html>
<head>
  <meta charset="utf-8" />
  <title>Go WebAssembly</title>
  <script src="./wasm_exec.js"></script>
</head>
<body>
  <h1>Go WebAssembly</h1>
  <button onClick="run();" id="runButton" disabled>BUTTON</button>
  <img id="image" />
  <script>
    const go = new Go();
    WebAssembly.instantiateStreaming(fetch("main.wasm"), go.importObject).then((result) => {
      go.run(result.instance)
      document.getElementById("runButton").disabled = false
    }).catch((err) => {
      console.error(err)
    })

    const imgElement = document.getElementById('image')

    function run() {
      const base64Data = drawMandelbrot()
      imgElement.src = 'data:image/png;base64,' + base64Data
    }
  </script>
</body>

</html>
